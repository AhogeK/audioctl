---
description: "结束当前会话：执行休眠存档，同步进度与架构决策至记忆体"
---

# 🌙 休眠存档与上下文交接指令

主理人即将结束当前会话，请严格按照以下流程执行"状态落盘"，不要遗漏：

- **阶段总结 (Recap)**：简要回顾本次会话中我们完成的核心代码或逻辑验证。

- **进度更新 (Progress Update)**：
    - 打开 `memory-bank/progress.md`，将本次会话已完成的任务打勾 `[x]`。
  - 将当前卡住的难点、或者建议下一次会话优先处理的任务，写入"阻塞与下一步"区域。

- **决策快照 (Decision Snapshot)**：
    - 回顾本次会话，如果我们在规避 Bug、API 选型上做出了重要妥协或决定，请立刻将其追加至 `memory-bank/decisions.md`。

- **任务状态落盘 (Task Sync)**：
    - 更新 bd 任务状态的建议由 AI 给出，由人类在终端执行（例如 `bd close <id>` / `bd create ...`）。
    - 若本次会话对任务关系有调整，提示人类执行 `bd dep ...` 相关命令修正依赖图。

- **交接包（Human-only 落地）**：
    - AI 输出：
        - 本次完成的可提交变更点摘要
        - 建议的测试点清单（哪些必须跑、哪些可选）
        - 建议的 commit message（可多条，按逻辑拆分）
    - 人类决定是否执行并完成：
        - 运行测试/格式化/构建门控
        - `git commit`
        - `git push`
        - 创建/更新 PR（如需要）

- **统一推送 (Git Push)**：
    - 执行 `git status` 检查是否有未提交的变更。
    - 执行 `git pull --rebase` 拉取远程变更。
    - 执行 `git push` 将所有变更（包括 bd 任务数据库、memory-bank、devlog）推送至远程。
    - **验证**: 再次执行 `git status`，必须显示 "up to date with origin"。

**🎯 执行完毕后，请在对话框输出：**
> "🌙 **休眠存档完毕**。记忆体已更新，期待下一次唤醒 `/boot`。本次共保存了 [N] 项进度，[N] 项关键决策，[N] 个 bd 任务已同步。"
